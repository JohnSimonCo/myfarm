"use strict";angular.module("app",["j$","server","translate","password","modal"]).controller("formController",["$scope","storage","sendRequest","getUserEmail","translate.userLanguage","translate.changeLanguage","attemptLogin","alert","translate","selectServerList","loginToServer","$timeout",function(a,b,c,d,e,f,g,h,i,j,k,l){a.email=d(),c("SrvLanguage.getLanguages",null).then(function(b){a.languages=b.langs,a.language=e.get(b.langs),null==b.servers||""==b.servers?a.servers=null:a.servers=b.servers.split(",").map(function(a){var b=a.split(";");return{name:b[0],url:b[1]}})}),a.changeLanguage=function(){f(a.language)},l(function(){a.email&&(a.form.$setDirty(),a.form.$setValidity())},50),a.attemptLogin=function(){a.submitted=!0,a.form.$valid&&g(a.email,a.password,a.servers).then(function(b){null!=b&&j(b).then(function(b){k(b,a.email)})})["catch"](function(a){h(i(a))})}}]).factory("getServers",["sendRequest","$q",function(a,b){return function(){return a("SrvUser.getServers")}}]).factory("selectServerList",["$modal","getServers","convertServerUrlToAppUrl","validateServerUrl","setServer","$window",function(a,b,c,d,e,f){return function(b){var c,d=f.location.origin,e=b.filter(function(a){return a.url===d});e.length>0?e[0].selected=!0:c=d;var g=a("login/set-farm-modal.html",{servers:b,customUrl:c});return g.result}}]).run(["$templateCache",function(a){a.put("login/set-farm-modal.html",'<modal class="set-server"><pre class="title" translate="Select server"></pre><div ng-repeat="server in servers"><button class="big-button black-button" translate-bind="server.name" ng-click="confirm(server)"></button></div><button class="big-button black-button cancel" ng-click="close()" translate="Cancel"></button></modal>')}]).run(["sendRequest",function(a){}]);